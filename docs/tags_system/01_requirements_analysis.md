# Система тегов команд - Анализ требований

## Обзор
Система тегов команд позволяет добавлять дополнительную функциональность к командам через специальные суффиксы, начинающиеся с нижнего подчеркивания.

## Требования

### 1. Общие требования к тегам
- Все теги начинаются с нижнего подчеркивания `_`
- Теги добавляются к концу команды
- Поддерживается множественное использование тегов
- Теги обрабатываются в порядке их появления

### 2. Тег `_wanted`
- **Назначение**: Проверка переменной `wanted` перед выполнением команды
- **Логика**: 
  - Если `wanted = true` → показывать диалог "закончилась жидкость"
  - Если `wanted = false` → выполнять команду нормально
- **UI**: Диалог с кнопками "Проверить жидкости" и "Отмена"
- **Поведение**: После подтверждения возврат к выполнению команды

### 3. Примеры использования
```
og_multizone-test_wanted          # Проверка wanted для мультизональной команды
test_wanted                       # Проверка wanted для обычной команды
og_multizone-paint_wanted_other   # Множественные теги
```

### 4. Архитектурные требования
- Интеграция с существующей системой команд
- Поддержка мультизональных команд
- Расширяемость для новых тегов
- Обратная совместимость

### 5. UI требования
- Модальный диалог для `_wanted`
- Интуитивный интерфейс
- Возможность отмены операции
- Индикация текущего состояния

### 6. Технические требования
- Thread-safe обработка
- Логирование всех операций
- Обработка ошибок
- Интеграция с системой мониторинга

## Структура системы

### Компоненты
1. **TagManager** - управление тегами
2. **TagValidator** - валидация тегов
3. **TagProcessor** - обработка тегов
4. **TagDialog** - UI диалоги для тегов
5. **TagTypes** - типы данных тегов

### Интерфейсы
- `ITagManager` - интерфейс менеджера тегов
- `ITagProcessor` - интерфейс обработчика тегов
- `ITagDialog` - интерфейс диалогов тегов

### Интеграция
- Расширение `CommandExecutor`
- Расширение `CommandValidator`
- Интеграция с `MultizoneManager`
- Интеграция с UI компонентами
